"use strict";var awaitingBytes=false;var buffer=new Buffer([]);function checkBufferLength(){var length=(buffer[3] << 8) + buffer[4];return buffer.length <= length + 5;}function processMessage(){return new Promise(function(resolve){var tlsVersion=buffer[9] + "." + buffer[10];var sessionIDLength=buffer[43];var cipherSuites=buffer[43 + sessionIDLength + 1] + " " + buffer[43 + sessionIDLength + 2];switch(tlsVersion){case "3.3":tlsVersion = "TLS 1.2";break;case "3.2":tlsVersion = "TLS 1.1";break;case "3.1":tlsVersion = "TLS 1.0";break;case "3.0":tlsVersion = "SSl 3.0";break;case "2.0":tlsVersion = "SSL 2.0";break;case "1.0":tlsVersion = "SSL 1.0";break;default:tlsVersion = "Unkonwn version: " + tlsVersion;break;}resolve({tlsVersion:tlsVersion,cipherSuite:[buffer[43 + sessionIDLength + 1],buffer[43 + sessionIDLength + 2]]});awaitingBytes = false;buffer = new Buffer([]);});}module.exports = function(data){if(!awaitingBytes){buffer = data;}else {buffer = Buffer.concat([buffer,data]);}awaitingBytes = checkBufferLength();if(!awaitingBytes){return processMessage();}return awaitingBytes;};